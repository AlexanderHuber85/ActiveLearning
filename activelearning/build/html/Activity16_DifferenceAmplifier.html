

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>16. Difference Amplifier &mdash; Red Pitaya 1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Red Pitaya 1.0 documentation" href="index.html"/>
        <link rel="next" title="17. Current Sensing using a Difference Amplifier" href="Activity17_CurrentSensingUsingDifferenceAmplifier.html"/>
        <link rel="prev" title="15. OPAMP Gain Bandwidth Product \(GBW\)" href="Activity15_OpAmpGainBandwidthProduct.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Red Pitaya
          

          
            
            <img src="_static/RedPitayaLogo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Activity01_Phase.html">1. What is Phase?</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity02_Kirchhoff.html">2. Kirchhoff’s Voltage and Current Laws</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity03_Voltage.html">3. Voltage Division</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity04_Proportionality.html">4. Proportionality and Superposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity05_Thevenin.html">5. Thévenin Equivalent Circuit and Maximum Power Transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity06_ResponseRC.html">6. Transient Response of RC Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity07_ResponseRL.html">7. Transient Response of an RL Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity08_ResonanceRCL.html">8. Resonance in RLC Circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity09_LowPassandHighPassFilters.html">9. Low Pass and High Pass Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity10_BandPassFilters.html">10. Band Pass Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity11_ImpedanceMeasurementFrequencyEffects.html">11. Impedance Measurement - Frequency Effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity12_MeasuringaLoudspeakerImpedanceProfile.html">12. Measuring a Loudspeaker Impedance Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity13_BasicOPAmpConfigurations.html">13. Basic OP Amp Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity14_OPAMPOpenLoopGain.html">14. OPAMP Open Loop Gain</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity15_OpAmpGainBandwidthProduct.html">15. OPAMP Gain Bandwidth Product <span class="math notranslate">\(GBW\)</span></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">16. Difference Amplifier</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#objective">16.1. Objective</a></li>
<li class="toctree-l2"><a class="reference internal" href="#notes">16.2. Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#short-background">16.3. Short Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="#materials">16.4. Materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="#procedure">16.5. Procedure</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Activity17_CurrentSensingUsingDifferenceAmplifier.html">17. Current Sensing using a Difference Amplifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity18_TheComparatorSchmittTrigger.html">18. The Comparator, Positive Feedback and Schmitt Trigger</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity19_Diodes.html">19. Diodes and Jupyter Notebook example</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity20_DiodeRectifiers.html">20. Diode Rectifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity21_PrecisionRectifiers.html">21. Precision Rectifiers, Absolute value circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity22_TheBJTasDiode.html">22. The BJT transistor connected as a diode</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity23_TheMOSAsDiode.html">23. The MOS transistor connected as a diode</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity24_TheBJTasSwitch.html">24. BJT transistor as a switch</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity25_MOSasSwitch.html">25. MOSFET transistor as a switch</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity26_BJTCommonEmitterAmplifier.html">26. BJT Common Emitter Amplifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity27_MOSCommonSourceAmplifier.html">27. MOS transistor common source amplifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity28_BoostConverter.html">28. DC-DC Boost Converter</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Red Pitaya</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>16. Difference Amplifier</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Activity16_DifferenceAmplifier.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="difference-amplifier">
<h1>16. Difference Amplifier<a class="headerlink" href="#difference-amplifier" title="Permalink to this headline">¶</a></h1>
<div class="section" id="objective">
<h2>16.1. Objective<a class="headerlink" href="#objective" title="Permalink to this headline">¶</a></h2>
<p>Adding and/or subtracting analog signals is potentially the most common function performed by an op-amp. This activity will investigate single op-amp circuits for subtracting two analog signals.
We have already discussed <a class="reference external" href="http://red-pitaya-active-learning.readthedocs.io/en/latest/Activity13_BasicOPAmpConfigurations.html#summing-amplifier-circuit">Summing</a> <a class="reference external" href="http://red-pitaya-active-learning.readthedocs.io/en/latest/Activity13_BasicOPAmpConfigurations.html#summing-amplifier-circuit">Amplifier</a> circuit;  a single op-amp circuits for adding two (or more) analog signals. Same behaviour we also expect here while signals in the opamp inputs should be subtracted and not summed together.</p>
</div>
<div class="section" id="notes">
<h2>16.2. Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<p>In this tutorials we use the terminology taken from the user manual when referring to the connections to the Red Pitaya STEMlab board <a class="reference external" href="http://redpitaya.readthedocs.io/en/latest/doc/developerGuide/125-10/top.html">hardware</a>.
Extension connector pins used for <strong>-3.3V</strong> and <strong>+3.3V</strong> voltage supply are show in the documentation <a class="reference external" href="http://redpitaya.readthedocs.io/en/latest/doc/developerGuide/125-14/extent.html#extension-connector-e2">here</a>.
<a class="reference external" href="http://redpitaya.readthedocs.io/en/latest/doc/appsFeatures/apps-featured/oscSigGen/osc.html">Oscilloscope</a> &amp; <a class="reference external" href="http://redpitaya.readthedocs.io/en/latest/doc/appsFeatures/apps-featured/oscSigGen/osc.html">Signal</a> <a class="reference external" href="http://redpitaya.readthedocs.io/en/latest/doc/appsFeatures/apps-featured/oscSigGen/osc.html">generator</a> application is used for generating and observing signals on the circuit.</p>
</div>
<div class="section" id="short-background">
<h2>16.3. Short Background<a class="headerlink" href="#short-background" title="Permalink to this headline">¶</a></h2>
<p>The basic difference opamp circuit is shown in figure 1.  To solve for the transfer function <span class="math notranslate">\(V_{out} = f(V_1,V_2)\)</span> of the difference amplifier we can use a superposition principle.</p>
<img alt="_images/Activity_16_Figure_1.png" src="_images/Activity_16_Figure_1.png" />
<p>Figure 1: Basic Difference Amplifier</p>
<p>In the first step consider circuit from figure 1 where noninverting input (pin 3) is set to the GND.
We get familiar inverting amplifier circuit which transfer function is given as</p>
<div class="math notranslate">
\[V_{out} = - V_1 \bigg( \frac{R_f}{R_i} \bigg)   \quad (1)\]</div>
<p>In second step consider the circuit from figure 1 where <span class="math notranslate">\(V_1\)</span> input is set to the GND.
We get familiar non-inverting amplifier circuit which transfer function is given as</p>
<div class="math notranslate">
\[V_{out} = V_2 \bigg( 1 + \frac{R_f}{R_i} \bigg) \quad (2)\]</div>
<p>Following superposition principle we get</p>
<div class="math notranslate">
\[V_{out} = V_{out_{step_1}}+V_{out_{step_2}}=V_2 \bigg( 1+ \frac{R_f}{R_i} \bigg) - V_1 \bigg(\frac{R_f}{R_i} \bigg) \quad (3)\]</div>
<p>From the equation above we can clearly see that circuit from figure 1 is indeed a difference amplifier where output signal <span class="math notranslate">\(V_{out}\)</span> is the  difference of the input signals <span class="math notranslate">\(V_2-V_1\)</span> amplified by factor <span class="math notranslate">\(\frac{R_f}{R_1}\)</span>.</p>
<p>For <span class="math notranslate">\(R_f = R_i\)</span>  we get:</p>
<div class="math notranslate">
\[V_{out} = 2V_2 -V_1 \quad (4)\]</div>
</div>
<div class="section" id="materials">
<h2>16.4. Materials<a class="headerlink" href="#materials" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Red Pitaya STEMlab</li>
<li>OPAMP:  1x OP484</li>
<li>Resistor:  4x 10 <span class="math notranslate">\(k \Omega\)</span></li>
</ul>
</div>
<div class="section" id="procedure">
<h2>16.5. Procedure<a class="headerlink" href="#procedure" title="Permalink to this headline">¶</a></h2>
<p>Build the difference amplifier shown in figure 2. R3 and R4 are added as a voltage divider in order to attenuate <span class="math notranslate">\(V_2^*\)</span> input signal by half.
With voltage divider (R3, R4) added, for circuit shown on figure 2 and from equation (4) we get</p>
<div class="math notranslate">
\[V_{out} = 2V_2 - V_1 = \frac{1}{2} 2 V_2^* - V_1 = V_2^* - V_1 = OUT_2 - OUT_1  \quad (5)\]</div>
<img alt="_images/Activity_16_Figure_2.png" src="_images/Activity_16_Figure_2.png" />
<p>Figure 2: Difference Amplifier</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Before connecting the circuit to the STEMlab -3.3V and +3.3V  pins double check your circuit. The  -3.3V and +3.3V  voltage supply pins do not have  short circuit handling and they can be damaged in case of short circuit.</p>
</div>
<img alt="_images/Activity_16_Figure_3.png" src="_images/Activity_16_Figure_3.png" />
<p>Figure 3: Difference Amplifier on the breadboard</p>
<ol class="arabic simple">
<li>Start the Oscilloscope &amp; Signal Generator application.</li>
<li>In the IN1 settings menu deselect SHOW button.</li>
<li>In the OUT1 settings menu set Amplitude value to 0.2V to apply a 0.4Vp-p sine wave centered on 0V as the input voltage <span class="math notranslate">\(V_1\)</span>. From the waveform menu select SINE and select enable.</li>
<li>In the OUT2 settings menu set Amplitude value to 0.6V to apply a 1.2Vp-p sine wave centered on 0V as the input voltage <span class="math notranslate">\(V_2^*\)</span>. From the waveform menu select SINE and select enable.</li>
<li>For the stable acquisition set the trigger source to IN2</li>
<li>On the left bottom of the screen be sure that  IN2 V/div is set to 200mV/div (You can set V/div by selecting the desired channel and using vertical +/- controls)</li>
<li>On the left bottom of the screen be sure that OUT1 V/div and OUT2 V/div are both set to 200mV/div (You can set V/div by selecting the desired channel and using vertical +/- controls)</li>
<li>In the measurement menu select “MAX” , select IN2 and press DONE</li>
</ol>
<img alt="_images/Activity_16_Figure_4.png" src="_images/Activity_16_Figure_4.png" />
<p>Figure 4: Difference Amplifier measurements</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As we can see from the measurements shown on the figure 4 our circuit behaves as a voltage difference amplifier since IN2 amplitude is equal to the difference between OUT2 and OUT1 amplitudes as it is predicted by equation (5).</p>
</div>
<p>Since both input signals are sinusoidal the only artefact of the difference amplifier circuit on the output signal is the difference in amplitude. But what happens when we have different waveforms of OUT1 and OUT2.</p>
<ol class="arabic simple">
<li>In the OUT2 settings menu select SQUARE waveform and observe results</li>
</ol>
<img alt="_images/Activity_16_Figure_5.png" src="_images/Activity_16_Figure_5.png" />
<p>Figure 5: Difference Amplifier measurements - Different waveforms of OUT1 and OUT2</p>
<p>From figure 5 we can observe a difference amplifier output signal (IN2) which has a strange waveform shape given as IN2(waveform)=OUT2(SQUARE) - OUT1(SINE).
This observation is absolutely confirming that circuit shown on figure 2 is a difference amplifier.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Try different OUT1 and OUT2 waveforms and observe results.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Activity17_CurrentSensingUsingDifferenceAmplifier.html" class="btn btn-neutral float-right" title="17. Current Sensing using a Difference Amplifier" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Activity15_OpAmpGainBandwidthProduct.html" class="btn btn-neutral" title="15. OPAMP Gain Bandwidth Product \(GBW\)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Red Pitaya d.d..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>