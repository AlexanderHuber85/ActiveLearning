

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>14. OPAMP Open Loop Gain &mdash; Red Pitaya 1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Red Pitaya 1.0 documentation" href="index.html"/>
        <link rel="next" title="15. OPAMP Gain Bandwidth Product \(GBW\)" href="Activity15_OpAmpGainBandwidthProduct.html"/>
        <link rel="prev" title="13. Basic OP Amp Configurations" href="Activity13_BasicOPAmpConfigurations.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Red Pitaya
          

          
            
            <img src="_static/RedPitayaLogo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Activity01_Phase.html">1. What is Phase?</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity02_Kirchhoff.html">2. Kirchhoff’s Voltage and Current Laws</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity03_Voltage.html">3. Voltage Division</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity04_Proportionality.html">4. Proportionality and Superposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity05_Thevenin.html">5. Thévenin Equivalent Circuit and Maximum Power Transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity06_ResponseRC.html">6. Transient Response of RC Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity07_ResponseRL.html">7. Transient Response of an RL Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity08_ResonanceRCL.html">8. Resonance in RLC Circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity09_LowPassandHighPassFilters.html">9. Low Pass and High Pass Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity10_BandPassFilters.html">10. Band Pass Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity11_ImpedanceMeasurementFrequencyEffects.html">11. Impedance Measurement - Frequency Effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity12_MeasuringaLoudspeakerImpedanceProfile.html">12. Measuring a Loudspeaker Impedance Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity13_BasicOPAmpConfigurations.html">13. Basic OP Amp Configurations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">14. OPAMP Open Loop Gain</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#objective">14.1. Objective</a></li>
<li class="toctree-l2"><a class="reference internal" href="#notes">14.2. Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#materials">14.3. Materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="#background">14.4. Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="#procedure">14.5. Procedure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-1-s-is-on-pos1-figure-2">14.5.1. Step 1: S is on POS1 (Figure 2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-2-s-is-on-pos2-figure-2">14.5.2. Step 2: S is on POS2 (Figure 2)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Activity15_OpAmpGainBandwidthProduct.html">15. OPAMP Gain Bandwidth Product <span class="math notranslate">\(GBW\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity16_DifferenceAmplifier.html">16. Difference Amplifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity17_CurrentSensingUsingDifferenceAmplifier.html">17. Current Sensing using a Difference Amplifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity18_TheComparatorSchmittTrigger.html">18. The Comparator, Positive Feedback and Schmitt Trigger</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity19_Diodes.html">19. Diodes and Jupyter Notebook example</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity20_DiodeRectifiers.html">20. Diode Rectifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity21_PrecisionRectifiers.html">21. Precision Rectifiers, Absolute value circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity22_TheBJTasDiode.html">22. The BJT transistor connected as a diode</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity23_TheMOSAsDiode.html">23. The MOS transistor connected as a diode</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity24_TheBJTasSwitch.html">24. BJT transistor as a switch</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity25_MOSasSwitch.html">25. MOSFET transistor as a switch</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity26_BJTCommonEmitterAmplifier.html">26. BJT Common Emitter Amplifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity27_MOSCommonSourceAmplifier.html">27. MOS transistor common source amplifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="Activity28_BoostConverter.html">28. DC-DC Boost Converter</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Red Pitaya</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>14. OPAMP Open Loop Gain</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Activity14_OPAMPOpenLoopGain.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="opamp-open-loop-gain">
<h1>14. OPAMP Open Loop Gain<a class="headerlink" href="#opamp-open-loop-gain" title="Permalink to this headline">¶</a></h1>
<div class="section" id="objective">
<h2>14.1. Objective<a class="headerlink" href="#objective" title="Permalink to this headline">¶</a></h2>
<p>The objective of this experiment is to measure  the open‐loop gain characteristics of a OP27 opamp.</p>
</div>
<div class="section" id="notes">
<h2>14.2. Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<p>In this tutorials we use the terminology taken from the user manual when referring to the connections to the Red Pitaya STEMlab board <a class="reference external" href="http://redpitaya.readthedocs.io/en/latest/doc/developerGuide/125-10/top.html">hardware</a>.
<a class="reference external" href="http://redpitaya.readthedocs.io/en/latest/doc/appsFeatures/apps-featured/oscSigGen/osc.html">Oscilloscope</a> &amp; <a class="reference external" href="http://redpitaya.readthedocs.io/en/latest/doc/appsFeatures/apps-featured/oscSigGen/osc.html">Signal</a> <a class="reference external" href="http://redpitaya.readthedocs.io/en/latest/doc/appsFeatures/apps-featured/oscSigGen/osc.html">generator</a> application is used for generating and observing signals on the circuit.
Extension connector pins used for <strong>-3.3V</strong> and <strong>+3.3V</strong> voltage supply are show in the documentation <a class="reference external" href="http://redpitaya.readthedocs.io/en/latest/doc/developerGuide/125-14/extent.html#extension-connector-e2">here</a>.</p>
</div>
<div class="section" id="materials">
<h2>14.3. Materials<a class="headerlink" href="#materials" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Red Pitaya STEMlab 125-14</strong>. An Red Pitaya STEMlab 125-10 is not suitable for this measurement due to ADC resolution!</li>
<li>OPAMP:  1x OP27</li>
<li>OPAMP:  1x OP97</li>
<li>Resistor:  2x 100 <span class="math notranslate">\(\Omega\)</span></li>
<li>Resistor:  2x 200 <span class="math notranslate">\(k \Omega\)</span></li>
<li>Resistor:  1x 100 <span class="math notranslate">\(k \Omega\)</span></li>
<li>Capacitor: 2x 0.1 <span class="math notranslate">\(\mu F\)</span></li>
<li>Capacitor: 1x 10 <span class="math notranslate">\(\mu F\)</span></li>
</ul>
</div>
<div class="section" id="background">
<h2>14.4. Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>Unlike the ideal op amp, a practical op amp has a finite gain. The open-loop DC gain (usually referred to as <span class="math notranslate">\(A_{VOL}\)</span> and sometimes as <strong>forward gain</strong>) is the gain of the amplifier without the feedback loop being closed, hence the name “open-loop.” For a precision op amp this gain can be very high, on the order of 160 dB (100 million) or more. The open loop gain of the <a class="reference external" href="http://www.analog.com/media/en/technical-documentation/data-sheets/OP27.pdf">OP27</a> amplifier is arround 1.8 million.</p>
<img alt="_images/Activity_14_Figure_1.png" src="_images/Activity_14_Figure_1.png" />
<p>Figure 1: OP27 datasheet and Open Loop Gain value marked</p>
<p>The definition of open-loop gain is</p>
<div class="math notranslate">
\[A_{OL} = \frac{V_{out}}{( V^+ − V^− )} \quad (1)\]</div>
<p>where <span class="math notranslate">\((V^+ − V^−)\)</span> is the input voltage difference <span class="math notranslate">\(V_d\)</span> that is being amplified, <span class="math notranslate">\(V^+\)</span> a voltage on noninverting input and <span class="math notranslate">\(V^-\)</span> voltage on inverting input.</p>
<p>Voltage feedback op amps operate as a <strong>voltage in / voltage out</strong> amplifier and the open-loop gain is a <strong>dimensionless ratio</strong>, so no units are necessary. However, data sheets sometimes express gain in
<span class="math notranslate">\(V/mV\)</span> or <span class="math notranslate">\(V/ \mu V\)</span> instead of <span class="math notranslate">\(V/V\)</span>, for the convenience of using smaller numbers. Or, voltage gain can also be expressed in <span class="math notranslate">\(dB\)</span> terms, as gain in</p>
<div class="math notranslate">
\[Gain \quad in \quad dB = 20log(A_{VOL})  \quad (2)\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Thus an open-loop gain of</p>
<div class="math notranslate">
\[1V/ \mu V \quad = \quad   1  \quad million V/V  \quad = \quad 120 dB, \quad etc.\]</div>
<p class="last">Be sure to read through the <a class="reference external" href="http://www.analog.com/media/en/training-seminars/tutorials/MT-044.pdf">tutorial</a> on Open Loop Gain and Open Loop Gain Nonlinearity before doing these experiments.</p>
</div>
</div>
<div class="section" id="procedure">
<h2>14.5. Procedure<a class="headerlink" href="#procedure" title="Permalink to this headline">¶</a></h2>
<p>The dc gain is measured by forcing the output of the DUT(OPAMP under test a OP27 in our case) to move by a known amount (1V in our case, look at Figure 2) by switching R5 between the DUT output (OP27 pin 6) and a 1V reference (STEMlab OUT1 output) with switch S. If R5 is at +1V (Switch S position POS2), then the DUT output (OP27 pin6) must move to –1V if the input of the auxiliary amplifier is to remain unchanged near zero. The voltage change at auxiliary amplifier output <span class="math notranslate">\(V_{out}\)</span> (OP97 pin 6), attenuated by <strong>R3/R1</strong> factor, is the input to the DUT(OP27 pin 3), which causes a 1V change of output.It is simple to calculate the gain from this:</p>
<div class="math notranslate">
\[A_{OL} = Gain_{OL} = \frac{R_3}{R_2}  \frac{1V}{V_{out}} \quad (2)\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In other words, DUT input differential voltage <span class="math notranslate">\(V_d=V^{+}+{V^-}\)</span>,(where <span class="math notranslate">\(V^-=0\)</span> and  <span class="math notranslate">\(V_d = V^+\)</span>), necessary to set DUT output to -1V is
<span class="math notranslate">\(\frac{V_{out}}{A_{OL}}\)</span>.</p>
<p class="last">DUT output must go to -1V since our AUX opamp is in feedback loop trying to push his <span class="math notranslate">\(V_d\)</span> to 0V.</p>
</div>
<p><strong>Example:</strong>
If we take <span class="math notranslate">\(A_{OL} = 1.8E6\)</span> then for 1V on DUT(OP27) output we need to have input diferential voltage <span class="math notranslate">\(V_d\)</span> as folows:</p>
<div class="math notranslate">
\[V_d = \frac{1V}{1.8E6} \approx 0.555 \mu V\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In theory, in order to measure <span class="math notranslate">\(A_{OL}\)</span>  we could only use a signal generator (for setting the <span class="math notranslate">\(V_{d}\)</span>) and voltmeter for measurements of DUT output. But in practice this is almost not duable dou to imperfections, noise levels, offset levels and etc. Because of that we are using method shown on figure 2 where we perform the measurements of output signal <span class="math notranslate">\(V_{out}\)</span> which is, through voltage divider (R3/R2) related to <span class="math notranslate">\(V_{d}\)</span> and  a few order of magnitudes larger than <span class="math notranslate">\(V_{d}\)</span> and thus measurable with our equipment.</p>
</div>
<p><strong>Construct the circuit shown in figure 2.</strong> Before inserting the R2 and R3 resistors in the circuit, measure and record the values of the two resistors using a DMM if available.
In our case R3 = 97.3k <span class="math notranslate">\(\Omega\)</span> and R2 = 99.7 <span class="math notranslate">\(\Omega\)</span></p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Before connecting the circuit to the STEMlab -3.3V and +3.3V  pins double check your circuit. The  -3.3V and +3.3V  voltage supply pins do not have  short circuit handling and they can be damaged in case of short circuit.</p>
</div>
<img alt="_images/Activity_14_Figure_2.png" src="_images/Activity_14_Figure_2.png" />
<p>Figure 2: Voltage supply connections and  test circuit</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">C1 capacitor is used as a feedback impedance on the inverting amplifier configuration of the AUX opamp. This is done to attenuate all AC signals in the circuit and AUX opamp output. For this reason it is good to have large capacitance of C1 in order to eliminate any AC signals.
We chosed 10uF and used polarized(electrolytic) capacitor here. This is not  an “ok” solution since our capacitor can be subjected to reverse polarisation. But for good measurements and short period of measurements the electrolytic capacitor can be used.</p>
</div>
<div class="section" id="step-1-s-is-on-pos1-figure-2">
<h3>14.5.1. Step 1: S is on POS1 (Figure 2)<a class="headerlink" href="#step-1-s-is-on-pos1-figure-2" title="Permalink to this headline">¶</a></h3>
<p>Instead of using switch S, R5 can be manually set on pin6 of DUT on the breadboard.
Build circuit in the breadboard and set R5 to POS1.
<strong>Connect OUT1 to IN1 and set probe attenuations to x1.</strong></p>
<img alt="_images/Activity_14_Figure_3.png" src="_images/Activity_14_Figure_3.png" />
<p>Figure 3: Test circuit. R5 on POS1 (look at Figure 2)</p>
<ol class="arabic simple">
<li>Start the Oscilloscope &amp; Signal Generator application</li>
<li>On the left bottom of the screen be sure that IN1 V/div is set to 500mV/div and IN2 V/div to 10mV/div (You can set V/div by selecting the desired channel and using vertical +/- controls)</li>
<li>Using  horizontal +/- controls set t/div to 100ms/div</li>
<li>In the measurement menu select “MEAN”, select IN1 and press DONE, select IN2 and press DONE</li>
<li><strong>Readout MEAN(IN2): In our case it is -34.2mV</strong></li>
</ol>
<img alt="_images/Activity_14_Figure_4.png" src="_images/Activity_14_Figure_4.png" />
<p>Figure 4: Measurements of <span class="math notranslate">\(V_{out}\)</span> when  R5 is set to POS1 (look at Figure 2)</p>
</div>
<div class="section" id="step-2-s-is-on-pos2-figure-2">
<h3>14.5.2. Step 2: S is on POS2 (Figure 2)<a class="headerlink" href="#step-2-s-is-on-pos2-figure-2" title="Permalink to this headline">¶</a></h3>
<p>Build circuit on the breadboard and set R5 to POS2.</p>
<img alt="_images/Activity_14_Figure_5.png" src="_images/Activity_14_Figure_5.png" />
<p>Figure 5: Test circuit. R5 on POS2 (look at Figure 2)</p>
<ol class="arabic simple">
<li>In the OUT1 settings menu from the waveform menu select DC. Set Amplitude value to 1V to apply a 1V DC voltage to the circuit (R5).
Deselect SHOW button and select enable.</li>
<li>Adjust OUT1 amplitude until MEAN(IN1) shows near 1V.</li>
<li><strong>Readout MEAN(IN2): In our case it is -34.8mV</strong></li>
</ol>
<img alt="_images/Activity_14_Figure_6.png" src="_images/Activity_14_Figure_6.png" />
<p>Figure 6: Measurements of <span class="math notranslate">\(V_{out}\)</span> when  R5 is set to POS2 (look at Figure 2)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>As you can see from the measurements there is certain offset on the AUX opamp output (pin 6). Ideally when R5 is set to POS1 (figure 2) <span class="math notranslate">\(V_{out}\)</span> should be 0.
Nonetheless, during both (POS1 and POS2) measurements the DC offset is the same and it will cancel out when calculating open loop gain.
For open loop gain folowing equation 2 we get:</p>
<div class="last math notranslate">
\[ \begin{align}\begin{aligned}A_{OL} = \frac{R3}{R2} \frac{1V}{(V_{out_{POS1}}-V_{out_{POS2}})} =\\.\\A_{OL} = \frac{93700.0}{99.7} \frac{1V}{(-34.2mV-(-34.8mV))} =\\.\\A_{OL} \approx  1566365.764 \approx 1.566 milion\end{aligned}\end{align} \]</div>
</div>
<p>Compare measurements with the datasheet value from Figure 2. Our measurements are very close to the specified value. For more accurate measurement a higher resolution equipment and less noisy environment is necessary.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Activity15_OpAmpGainBandwidthProduct.html" class="btn btn-neutral float-right" title="15. OPAMP Gain Bandwidth Product \(GBW\)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Activity13_BasicOPAmpConfigurations.html" class="btn btn-neutral" title="13. Basic OP Amp Configurations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Red Pitaya d.d..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>